# <center> 深度学习  
## 一、人工神经网络基础  
### 1、机器学习
本质：利用算法分析数据、找寻数据规律最终通过这些规律预测或者做出判断。  
### 2、深度学习
作为机器学习的一个子领域，深度学习是基于大脑的神经网络结构和功能（当然并不是真正的生物神经网络），因此深度学习中使用的神经网络被称为“人工神经网络”。  
“人工神经网络”（ANN）中，需要知道：  
1.ANN 是利用我们所谓的神经元构建的。  
2.ANN 中的神经元被组织成所谓的层。  
3.ANN中的 层 （除输入层和输出层之外的所有层）称为隐藏层。  
4.如果 ANN 具有多个隐藏层，则该 ANN 被称为深度 ANN。  
#### ANN结构
深度学习中使用的模型被称为人工神经网络（ANN），这是一种计算系统，由一组称为神经元的链接单元组成，这些神经元组织成层，在ANN中有三种类型的层。  
> 1.输入层————输入数据的每个组件都有一个节点  
> 2.隐藏图层————每个隐藏层的节点数量任意选择  
> 3.输出层————每个可能的期望输出都有一个节点  
>> 以下图为参考示例，左侧的为输入层右侧的为输出层，中间的则是隐藏层。在这里介电泳圆圈来表示。
![alt text](image.png)

#### keras顺序模型
接下来使用keras在代码中构建ANN  
* 首先需要导入所需的keras类
> from keras.models import Sequential  
> from keras.layers import Dense,Activation  

* 创建一个变量model，将其设置为Sequential的实例对象
> model = Sequential(layers)  

* 向构造提供一个数组Dense，在Dense中的每一个对象实际上都是层。  
> layers = [  
    Dense(units=3, input_shape=(2,), activation='relu'),  
    Dense(units=2, activation='softmax')  
]  

### 3、神经网络中各种层
主要分类有：  
* 密集层（或称为全连接层）
* 卷积层
* 池化层
* 循环层  
* 规范化层  

为了让神经网络效率更高，因此将不同层进行分类，以此让这些层执行它们最合适的任务。
以下示例：  
![alt text](image-1.png)  
第一层为输入层，有八个节点，说明数据集中一个样本由八个维度组成，即一个样本中含有八个值，最右边的那一层为输出层，输入层和输出层之间都是隐藏层。由此可见，隐藏层的节点数以及层数是不定的，那么大部分的层（即上面提到的密集层等）大多都集中在隐藏层。
#### 层权重
两个节点之间的每个连接都有一个相关的权重，权重仅是一个数字。  
* 权重表示的是两个节点之间的连接强度，决定了前一层某个节点的输出值对后一层另一个节点激活程度的影响力。（当网络在输入层的给定节点接收到输入时，该输入将通过连接传递到下一个节点，并且该输入将乘以分配给该连接的权重。）  
对于第二层中的每个节点，使用每个传入连接计算加权和，两个节点的连接中有某个函数（激活函数），该函数会对给定的和执行某种类型的转换，再传入下一个节点。

> 节点输出 = 激活函数（输入的加权和）  

以上过程持续进行，一直到输出层。
### 4、激活函数  
定义：激活函数是将节点的输入映射到其相应输出的函数，会进行某种非线性转换。  
* Sigmoid函数  
它有以下作用：

>1.对于大多数负输入，会将其转换成非常接近数字0的数  
2.对于大多数正输入，会将其转换成接近1的数  
3.对于接近于0的输入，函数会将其转化为介于0和1之间的数。  

函数大致模样：
![alt text](image-2.png)  

* Relu激活函数  
relu（x） = max（0，x）  

应用于伪代码是这样的：
>relu（x）{  
    if(x<=0>){  
        return 0;  
    } else{  
        return x;  
    }  
}  

大多数激活函数是非线性函数，因为如果使用线性函数，那么从输入层到输出层我们会发现都是进行线性变化，那么就无法做出复杂的计算以及计算复杂的数据。  

### 5、人工神经网络训练
目的：找到最准确地将输入数据映射到正确输出类别的权重，本质上来说是为了让神经网络中数据传递时误差的减少。  
* 例如要分类猫和狗的照片，给一张猫的照片，也可能有一定概率分到狗的类别去，因此我们需要不断训练，给输出层的不同节点所需接受的数据进行“打标签”使误差减小，这样才能更好的进行分类。  

#### 优化算法
优化算法（又称为“优化器”）来将权重进行优化，最广为人知的优化器为SGD。  
SGD的目标是优化某个给定函数，这个给定函数被称为损失函数。
损失函数的例子与上面类似，损失函数的输出结果就是没有正确分类的概率，那么SGD得去优化它，使它的误差减小。那么这样的话就可以使模型进行学习，致使下次的运行效率更高。   
* 优化器是为了最小化损失函数的输出！！

获得了输出后，就可以通过查看模型预测的结果与真实标签的对比来计算该特定输出的损失（或者误差）。损失计算取决于所选的损失函数。  
#### 损失函数梯度(表示了多个变量函数的导数)
>1.梯度表示了误差对模型参数的影响   
2.梯度通过反向传播算法计算，层层传递误差信息。  
3.梯度的计算取决于所选的损失函数。

梯度主要的作用是最小化误差和提高模型性能。  

获取梯度值后将其乘以一个成为学习率的数值，范围在0.0001~0.01之间。  
* 学习率告诉我们应该朝着最小值的方向迈出多大的一步  
#### 更新权重
权重减去梯度和学习率的乘积，结果为新的权重值。  
* 新权重 = 旧权重 - （学习率*梯度）  

#### 均方误差（MSE）
* MSE（输入） = （输出 - 目标标签值）^ 2  

#### 学习率
在机器训练的过程中，越来越接近最小化损失，在这个过程中权重也在逐步更新，而在最小化损失而采取的步骤导向取决于学习率。  
也就意味着学习率可以被视为步长。  
* 新权重 = 旧权重 - （学习率 * 梯度）   

学习率是一个超参数，因此需要在模型中测试和调整。通常学习率设置在其范围的一个较低值。
### 6、深度学习数据集
>1.训练集  
2.验证集  
3.测试集  

#### 训练集
用于训练模型的数据集，通过相同的数据反复训练模型进而然模型学习数据的各个特征。  
#### 验证集 
用于训练时验证模型，帮助调整超参数的值，和训练集不同，验证集是独立出来的，但也会用于训练中。  
* 验证集主要作用是为了防止模型不会过度拟合训练集中的数据。（其中有过度拟合和欠拟合）  
* 验证集让我们看到模型在训练期间的泛化情况。  
#### 测试集  
来检查训练结果，得出模型最后的效果。  
在将模型部署到生产之前，测试集提供了最终检查，确保模型具有良好的泛化能力。  

##### 训练集就相当于平常上课的练习，验证集是课后作业，测试集是考试。